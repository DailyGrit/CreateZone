(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[687],{3208:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/post/[id]",function(){return s(6413)}])},6463:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});var a=s(8967);let n=(0,a.eI)("https://vyyzimksztofhrpkvqdl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5eXppbWtzenRvZmhycGt2cWRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMjYwNjMsImV4cCI6MjA2MjgwMjA2M30.uvB93khLu9Iv3t1n1O61KOO6_ufAf9l4bt1DNPu-SIo")},6413:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var a=s(5893),n=s(1163),i=s(7294),c=s(6463);function r(){let e=(0,n.useRouter)(),{id:t}=e.query,[s,r]=(0,i.useState)(null),[l,o]=(0,i.useState)([]),[d,u]=(0,i.useState)(""),[m,p]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=async()=>{let{data:{user:e}}=await c.O.auth.getUser();p(e)};e()},[]),(0,i.useEffect)(()=>{if(!t)return;let e=async()=>{let{data:e,error:s}=await c.O.from("posts").select("*").eq("id",t).single();s||r(e)},s=async()=>{let{data:e,error:s}=await c.O.from("comments").select("*").eq("post_id",t).order("created_at",{ascending:!0});s||o(e)};e(),s()},[t]);let x=async e=>{if(e.preventDefault(),!d.trim()||!m)return;let{error:s}=await c.O.from("comments").insert([{post_id:t,content:d,user_id:m.id}]);if(!s){u("");let{data:e}=await c.O.from("comments").select("*").eq("post_id",t).order("created_at",{ascending:!0});o(e||[])}};return s?(0,a.jsxs)("div",{className:"max-w-3xl mx-auto p-6 bg-white shadow rounded mt-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-indigo-700",children:s.title}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:s.summary}),(0,a.jsx)("div",{className:"mt-6 text-gray-800 whitespace-pre-line",children:s.content}),(0,a.jsxs)("div",{className:"mt-10 border-t pt-6",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-4",children:"댓글"}),l.map(e=>(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-700 whitespace-pre-line",children:e.content}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleString()})]},e.id)),m?(0,a.jsxs)("form",{onSubmit:x,className:"mt-4 space-y-2",children:[(0,a.jsx)("textarea",{className:"w-full border px-3 py-2 rounded",placeholder:"댓글을 입력하세요...",value:d,onChange:e=>u(e.target.value)}),(0,a.jsx)("button",{type:"submit",className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700",children:"등록"})]}):(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-4",children:"로그인 후 댓글을 작성할 수 있습니다."})]})]}):(0,a.jsx)("p",{className:"p-6 text-gray-600",children:"불러오는 중..."})}},1163:function(e,t,s){e.exports=s(6885)}},function(e){e.O(0,[774,967,888,179],function(){return e(e.s=3208)}),_N_E=e.O()}]);